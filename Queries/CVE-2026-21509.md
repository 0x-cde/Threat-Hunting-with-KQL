# CVE-2026-21509

## Intro
On 2026-01-26 Microsoft released the following advisory about a vulnerability exploited in the wild. From Microsoft *`Reliance on untrusted inputs in a security decision in Microsoft Office allows an unauthorized attacker to bypass a security feature locally`*. This results in allowing Threat Actors to execute code from the internet when the user opens the malicious Office file.



## Expected outcomes and suggested actions

It should not be expected for *`rundll32.exe`* to run as a child process of any Office product. In case of a hit, it should be expected that the CommandLine contains a URL. In any case, check for network connections from this process and investigate accordingly.

## Additional Info

- https://decalage.info/CVE-2026-21509/
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-21509
- https://nvd.nist.gov/vuln/detail/CVE-2026-21509
- Sample: https://www.virustotal.com/gui/file/b2ba51b4491da8604ff9410d6e004971e3cd9a321390d0258e294ac42010b546


## Kusto Query

``` 
DeviceProcessEvents
| where ProcessCommandLine has_any (@'C:\Windows\system32\shell32.dll,Control_RunDLL',@'C:\Windows\system32\davclnt.dll,DavSetCookie')
| where TimeGenerated > ago(90d)
| where InitiatingProcessVersionInfoProductName =~ "Microsoft Office"
| extend URL=url_decode(tostring(extract(@"(\b((ht|f)tp(s)?:\/\/|www\.)+[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9]{2,}((\/)?([-a-zA-Z0-9@:%_\+.~#?&\/=]*)?)\b)",0,ProcessCommandLine)))
| extend BaseSiteURL=tostring(split(tostring(split(URL,"//")[1]),"/")[0])
| project-reorder TimeGenerated, AccountName, ProcessCommandLine, FileName, InitiatingProcessFileName, InitiatingProcessParentFileName, InitiatingProcessVersionInfoProductName, URL, BaseSiteURL
```

## Mitre Att&ck Techniques

- Initial Access - [T566.001 - Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001/)
- Execution - [T1203 - Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203/)
- Defense Evasion - [T1211 - Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211/)